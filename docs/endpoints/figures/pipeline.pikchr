
S: circle "start" fit
arrow
MDB: box "generate-db" fit
arrow
P: box "synthetic-queries" fit
arrow
F1: box "filter-synthetic" fit
arrow
LLM: box "extensions-with-ollama" fit
arrow
FT: box "fix-transform" fit
arrow
circle "dataset" "ready" fit







H: box "make-histograms" fit at (P + (0,-2))
arrow dashed from S.s to H.nw "for non" aligned "precomputed DB" aligned
F: file "histogram" at ( P + (1.5,-1.2)) fit
arrow from H.n to F.s "generates" aligned ""
arrow <- from P.s to F.n "uses" aligned ""
spline from S.n  up 0.5 then right until even with P.nw then to P.nw dashed ->
text "If database is not supported" at (MDB + (0,0.74)) "" "for generation"

DB: cylinder "DuckDB Database" fit at (P + (0,-1))
arrow from P.s to DB.n "run" aligned "queries" aligned
arrow from MDB.s to DB.nw "generates" aligned "DuckDB database" aligned
arrow from H.n to DB.s  "queries" aligned ""
spline <- from DB.ne right 0.5 then to LLM.sw dashed "Syntax Check" aligned
spline <- from DB.ne right 0.5 then to FT.sw dashed "Trace Collect" aligned ""


PARQUET: file "cardinalities" fit at (P + (0.5,1.3))
arrow from P.n to PARQUET.sw "generates" aligned "parquet" aligned
arrow  from PARQUET.se  to F1.n "uses" aligned "cardinalities" aligned

GM: box "get-metrics" fit at (FT + (0,-0.5))
arrow from FT.s to GM.n
HP1: file at (GM + (-0.1,-0.9)) fill white
file at (GM + (0,-1)) fill white
file at (GM + (0.1,-1.1)) fill white "hist" "plots"
arrow from GM.s down until even with HP1.n


DDBT1: file at (FT + (-0.1,0.9)) fill white
file at (FT + (0,1)) fill white
file at (FT + (0.1,1.1)) fill white "duckdb" "traces"
arrow from FT.n up until even with DDBT1.s
